import{r as i,g as m,d as C,u as M,j as e,S,a as c,p as E,b as T,c as A,e as F,f as D,h as N}from"./index-_QpQq_oz.js";import{S as d}from"./StyleCard-C2KBX-HB.js";import{u as G}from"./useQuery-NTY-A1YK.js";import{I as P}from"./index.es-v7EqZUek.js";let w=0;const u=30;let x=0;const L=()=>{const s=i.useCallback(a=>{a.touches[0].pageY-w>=u?m.show_nav=!1:a.touches[0].pageY-w<=-u&&(m.show_nav=!0)},[]),l=i.useCallback(a=>{w=a.touches[0].pageY},[]),n=i.useCallback(a=>{const t=a.target.scrollTop;x===0?x=t:x-t>=u?(m.show_nav=!1,x=0):x-t<=-u&&(m.show_nav=!0,x=0)},[]);return{onTouchMove:s,onTouchStart:l,onScroll:n}},b=C.div`
  width: 100vw;
  /* height: 50px; */
  .swiper {
    width: 100%;
    height: 100%;
  }

  .swiper-slide {
    text-align: center;
    font-size: 18px;

    /* Center slide text vertically */
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .swiper-slide img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
`,z=C.div`
  overflow: hidden;
  height: ${({style_selected:s})=>s===0?"0px":"74px"};
  transition: all 0.3s;
  margin: 6px 0;
`,B=()=>{const s=M(),l=[{title:"ðŸ’ƒChinese style",id:1},{title:"ðŸ¤  Cowboy",id:2},{title:"ðŸ’ƒHahahahaah",id:3},{title:"ðŸ’ƒChinese",id:4},{title:"ðŸ’ƒOoooooooooooo~",id:5}],[n,a]=i.useState(0);return e.jsxs("div",{children:[e.jsx("div",{className:" flex justify-center",children:n===0?e.jsx("img",{src:"/images/font-select-style.png",alt:""}):e.jsx("img",{src:"/images/font-view-creates-in-style.png",alt:""})}),e.jsx(z,{style_selected:n===0?0:1,children:e.jsx(b,{children:e.jsxs(S,{slidesPerView:3,spaceBetween:30,pagination:{clickable:!0},className:"mySwiper",children:[e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})}),e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})}),e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})}),e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})}),e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})}),e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})}),e.jsx(c,{children:e.jsx("div",{className:"h-[71px] w-[111px]",children:e.jsx(d,{})})})]})})}),e.jsx("div",{children:e.jsx(b,{children:e.jsxs(S,{slidesPerView:3,spaceBetween:30,pagination:{clickable:!0},className:"mySwiper",children:[e.jsx(c,{className:" w-4"}),l.map(t=>e.jsx(c,{children:e.jsx("button",{className:"btn btn-outline p-1 h-[34px]",style:{background:n===t.id?"#948C8C":void 0},onClick:()=>{a(t.id)},children:e.jsx("span",{className:" text-sm",children:t.title})})},t.id)),e.jsx(c,{children:e.jsxs("button",{onClick:()=>{s("/style")},className:"btn btn-outline p-1 h-[34px]",children:[e.jsxs("div",{className:" flex flex-col items-center justify-center leading-[8px] -mt-2",children:[e.jsx("span",{children:"."}),e.jsx("span",{children:"."}),e.jsx("span",{children:"."})]}),e.jsx("span",{className:" text-sm",children:"more"})]})})]})})})]})},H=B;function O(){const s=M();return e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-outline p-1 h-[34px] w-[117px] mr-[11px]",onClick:()=>{s("/my_create")},children:e.jsx("span",{className:"text-sm text-pingfang font-normal",children:"My Creation"})}),e.jsx("button",{className:"btn btn-outline p-1 h-[34px] w-[117px]",onClick:()=>{s("/style")},children:e.jsx("span",{className:" text-sm text-pingfang font-normal",children:"Select a style"})})]})}var h=(s=>(s[s.IMAGE=0]="IMAGE",s[s.TEXT=1]="TEXT",s))(h||{});const j=E({chat_list:[]}),X=s=>new Promise(l=>{setTimeout(()=>{l(s)},s)}),Y=()=>T(j),q=[{type:h.IMAGE,isMine:!0,time:Date.now(),id:String(Math.random()),img:{url:"/images/pic-msg.png"}},{type:h.TEXT,isMine:!1,time:Date.now(),id:String(Math.random()),text:{content:"It looks great. I have chosen for you the most popular style currently used in iDAO"}},{type:h.IMAGE,isMine:!1,time:Date.now(),id:String(Math.random()),img:{url:"It looks great. I have chosen for you"}}],V=()=>{const[s,l]=i.useState(1),[n,a]=i.useState(!1),{data:t,isPending:f,refetch:g}=G({queryKey:["get_chat_list",s],queryFn:async()=>(await X(2e3),{data:{data:q,page:2,page_size:3}})});i.useEffect(()=>{if(t!=null&&t.data){const o=t.data;o.page===1?j.chat_list=o.data:j.chat_list=[...o.data,...j.chat_list],o.data.length<t.data.page_size?a(!0):a(!1)}},[t]);const v=i.useCallback(()=>{l(o=>o+1)},[]);return{data:t,isPending:f,refetch:g,loadMore:v,load_end:n}};function U(){const s=A(),{compressedFileHandle:l,uploadHandle:n}=F(),{setInitFile:a}=D(),t=i.useCallback(async()=>{if(s.init_file&&N.init_file){a(!1);const r=await l(N.init_file),p=await n(r);console.log(p)}},[s.init_file,l,a,n]);i.useEffect(()=>{t()},[t]);const{onTouchMove:f,onTouchStart:g,onScroll:v}=L(),o=i.useMemo(()=>!0,[]),y=Y(),{loadMore:k,load_end:I}=V();return e.jsxs("div",{className:"relative h-full ",children:[e.jsx("div",{onTouchMove:f,onTouchStart:g,onScrollCapture:v,className:" relative h-full overflow-auto",children:e.jsx(P,{dataLength:y.chat_list.length,next:k,hasMore:!I,inverse:!0,loader:e.jsx("div",{className:" flex justify-center items-center",children:e.jsx("span",{className:"loading loading-dots loading-sm"})}),endMessage:e.jsx("p",{style:{textAlign:"center"},children:e.jsx("b",{})}),children:e.jsxs("div",{className:" px-8 pt-5",children:[y.chat_list.map(r=>{var p,_;return e.jsx("div",{children:e.jsxs("div",{className:r.isMine?" mt-2  flex items-end  flex-col":" mt-2",children:[e.jsx("div",{children:r.isMine?e.jsx("span",{children:"Me"}):e.jsx("img",{src:"/images/bot.png",className:" w-[76px]",alt:""})}),e.jsx("div",{className:r.isMine?" mt-2  w-10/12  flex items-end  flex-col":" mt-2  w-10/12",children:r.type===h.IMAGE?e.jsx("img",{className:" w-max-[126] ",src:(p=r.img)==null?void 0:p.url,alt:""}):e.jsx("div",{className:" w-10/12",children:(_=r.text)==null?void 0:_.content})})]})},r.id)}),e.jsx("div",{className:" h-[200px]"})]})})}),e.jsx("div",{className:"  absolute bottom-0 bg-[#1c1919] pb-3 w-full",children:o?e.jsx("div",{className:" ml-6",children:e.jsx(O,{})}):e.jsx(H,{})})]})}export{U as default};
